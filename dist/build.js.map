{"version":3,"sources":["webpack:///webpack/bootstrap 29396dad9e8effbbc9f1","webpack:///./server/config/environment/index.js","webpack:///external \"express\"","webpack:///external \"mongoose\"","webpack:///./server/app.js","webpack:///external \"pmx\"","webpack:///external \"path\"","webpack:///external \"lodash\"","webpack:///./server/config/environment ^\\.\\/.*\\.js$","webpack:///./server/config/environment/development.js","webpack:///./server/config/environment/production.js","webpack:///./server/config/environment/test.js","webpack:///external \"http\"","webpack:///./server/config/express.js","webpack:///external \"compression\"","webpack:///external \"body-parser\"","webpack:///external \"method-override\"","webpack:///external \"cookie-parser\"","webpack:///./server/routes.js","webpack:///./server/api/index.js","webpack:///./server/api/organization/index.js","webpack:///./server/api/auth/auth.service.js","webpack:///external \"composable-middleware\"","webpack:///./server/api/organization/organization.controller.js","webpack:///./server/api/organization/organization.service.js","webpack:///./server/api/organization/organization.model.js","webpack:///external \"blind\"","webpack:///./server/config/logger.js","webpack:///external \"winston\"","webpack:///external \"winston-loggly\""],"names":["path","require","_","all","env","process","NODE_ENV","root","normalize","join","__dirname","port","PORT","secrets","session","nodePass","me","mongo","uri","options","db","safe","prefix","logger","level","info","warn","error","loggly","inputToken","subdomain","tags","encryptKey","module","exports","merge","init","http","ignore_routes","errors","custom_probes","network","ports","connect","app","server","createServer","listen","ip","console","log","get","err","mongoHost","TDUSER_MONGO_HOST","commerce","magento","host","login","pass","paymentPlan","intervalElapsed","intervalType","use","urlencoded","extended","json","route","response","status","PU","express","router","Router","post","isAuthenticated","organizationRequest","organizationResponse","put","organizationResponseUpdate","getOrganization","authService","req","res","next","token","serverTokenAuthenticated","localToken","sendStatus","query","hasOwnProperty","body","headers","authorization","organizationController","userId","organizationInfo","organization","handleError","organizationId","_id","params","id","name","message","paymentId","findById","httpErrorCode","code","organizationService","save","cb","data","create","findOne","filter","fields","find","update","value","encryptField","encrypted","encrypt","decryptField","encryptedValue","decrypted","decrypt","getlast4Field","last4Field","substring","length","dataOrganization","ownerId","aba","dda","ownerSSN","newOrganization","verify","mongoose","Schema","config","organizationSchema","type","String","ownerFirstName","required","ownerLastName","ownerDOB","Date","ownerEmail","ownerPhone","country","default","state","city","zipCode","averagePayment","EIN","Address","AddressLineTwo","website","businessName","businessType","createAt","updateAt","referralCode","seasons","pre","isNew","update_at","model","winston","Logger","transports","Console","handleExceptions","colorize","File","filename","maxsize","maxFiles","Loggly","exitOnError","emitErrs","remove","stream","write","encoding"],"mappings":"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","file":"build.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 29396dad9e8effbbc9f1","'use strict'\n\nconst path = require('path')\nconst _ = require('lodash')\n\n// All configurations will extend these options\n// ============================================\nlet all = {\n  env: process.env.NODE_ENV,\n\n  // Root path of server\n  root: path.normalize(path.join(__dirname, '/../../..')),\n\n  // Server port\n  port: process.env.PORT || 9007,\n\n  // Secret for session, you will want to change this and make it an environment variable\n  secrets: {\n    session: 'puproduct-secret'\n  },\n\n  nodePass: {\n    me: {\n      'token': 'puproduct-secret'\n    }\n  },\n  // MongoDB connection options\n  mongo: {\n    uri: 'mongodb://localhost/convenience-dev',\n    options: {\n      db: {\n        safe: true\n      },\n      prefix: 'puproduct_'\n    }\n  },\n\n  logger: {\n    level: {\n      info: 'info',\n      warn: 'warn',\n      error: 'error'\n    },\n    loggly: {\n      inputToken: 'e2834f96-0326-43f1-8fd9-04dd669a11ef',\n      subdomain: 'cstest',\n      tags: ['PUProduct'],\n      level: 'error'\n    }\n  },\n  encryptKey: 'PZ3oXv2v6Pq5HAPFI9NFbQ=='\n}\n\n// Export the config object based on the NODE_ENV\n// ==============================================\nmodule.exports = all\nmodule.exports = _.merge(\n  all,\n  require('./' + process.env.NODE_ENV + '.js') || {})\n\n\n\n// WEBPACK FOOTER //\n// ./server/config/environment/index.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 2\n// module chunks = 0","import pmx from 'pmx'\nimport express from 'express'\nimport mongoose from 'mongoose'\nimport config from './config/environment'\nimport http from 'http'\nimport configExpress from './config/express'\nimport routes from './routes'\n\nprocess.env.NODE_ENV = process.env.NODE_ENV || 'development'\n\npmx.init({\n  http: true, // HTTP routes logging (default: true)\n  ignore_routes: [/socket\\.io/, /notFound/], // Ignore http routes with this pattern (Default: [])\n  errors: true, // Exceptions loggin (default: true)\n  custom_probes: true, // Auto expose JS Loop Latency and HTTP req/s as custom metrics\n  network: true, // Network monitoring at the application level\n  ports: true // Shows which ports your app is listening on (default: false)\n})\n\nmongoose.connect(config.mongo.uri, config.mongo.options)\n\nconst app = express()\nconst server = http.createServer(app)\nconfigExpress(app)\nroutes(app)\n\n// Start server\nif (config.env !== 'test') {\n  try {\n    server.listen(config.port, config.ip, function () {\n      console.log('Express server listening on %d, in %s mode', config.port, app.get('env'))\n    })\n  } catch (err) {\n    console.log('error:', err)\n  }\n}\n\nexport default app\n\n\n\n// WEBPACK FOOTER //\n// ./server/app.js","module.exports = require(\"pmx\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"pmx\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 6\n// module chunks = 0","var map = {\n\t\"./development.js\": 8,\n\t\"./index.js\": 0,\n\t\"./production.js\": 9,\n\t\"./test.js\": 10\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 7;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/config/environment ^\\.\\/.*\\.js$\n// module id = 7\n// module chunks = 0","// Development specific configuration\n// ==================================\nconst mongoHost = process.env.TDUSER_MONGO_HOST || 'localhost'\nmodule.exports = {\n  port: process.env.PORT || 9007,\n  mongo: {\n    uri: 'mongodb://' + mongoHost + '/convenience-dev',\n    options: {\n      prefix: 'puproduct_'\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/config/environment/development.js","'use strict'\n\n// Production specific configuration\n// =================================\nconst mongoHost = process.env.TDUSER_MONGO_HOST || 'localhost'\nmodule.exports = {\n  // Server IP\n  mongo: {\n    uri: 'mongodb://' + mongoHost + '/convenience-dev',\n    options: {\n      prefix: 'puproduct_'\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/config/environment/production.js","'use strict'\n\n// Test specific configuration\n// ===========================\nmodule.exports = {\n  // MongoDB connection options\n  mongo: {\n    uri: 'mongodb://localhost/convenience-test',\n    options: {\n      prefix: 'puproduct_'\n    }\n  },\n  commerce: {\n    magento: {\n      host: 'develop.getpaidup.com',\n      port: 8888,\n      path: '/api/xmlrpc/',\n      login: 'magento',\n      pass: 'Sv38SJVR'\n    },\n    paymentPlan: {\n      intervalElapsed: 5,\n      intervalType: 'minutes'\n    }\n  },\n  nodePass: {\n    me: {\n      me: 'tdschedule-secret'\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/config/environment/test.js","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 11\n// module chunks = 0","/**\n * Express configuration\n */\n\nimport compression from 'compression'\nimport bodyParser from 'body-parser'\nimport methodOverride from 'method-override'\nimport cookieParser from 'cookie-parser'\n\nexport default function (app) {\n  app.use(compression())\n  app.use(bodyParser.urlencoded({ extended: false }))\n  app.use(bodyParser.json())\n  app.use(methodOverride())\n  app.use(cookieParser())\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/config/express.js","module.exports = require(\"compression\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"compression\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"method-override\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"method-override\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 16\n// module chunks = 0","export default function (app) {\n  // Insert routes below\n  app.use('/api/v1', require('./api'))\n\n  app.route('/*').get(function (error, response) {\n    if (error) return response.status(500).json({ error })\n    response.status(200).json({ PU: 'Product!!!' })\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes.js","'use strict'\n\nconst express = require('express')\nconst router = express.Router()\n\nrouter.use('/organization', require('./organization'))\nmodule.exports = router\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/index.js","import express from 'express'\nimport authService from '../auth/auth.service'\nimport controller from './organization.controller'\n\nconst router = express.Router()\n\nrouter.post('/request', authService.isAuthenticated(), controller.organizationRequest)\nrouter.get('/response/:id', authService.isAuthenticated(), controller.organizationResponse)\nrouter.put('/response/:id/:paymentId', authService.isAuthenticated(), controller.organizationResponseUpdate)\n\nrouter.get('/:organizationId', authService.isAuthenticated(), controller.getOrganization)\n\nmodule.exports = router\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/organization/index.js","import config from '../../config/environment'\nimport compose from 'composable-middleware'\n/**\n * Attaches the user object to the request if authenticated\n * Otherwise returns 403\n */\n\nconst authService = {}\n\nauthService.isAuthenticated = function () {\n  return compose().use(function (req, res, next) {\n    let token = serverTokenAuthenticated(req)\n    let localToken = config.nodePass.me.token\n    if (token === localToken) {\n      return next()\n    } else {\n      return res.sendStatus(401)\n    }\n  })\n}\n\nfunction serverTokenAuthenticated (req) {\n  let token = null\n  // allow access_token to be passed through query parameter as well\n  if (req.query && req.query.hasOwnProperty('token')) {\n    token = req.query.token\n  } else if (req.body && req.body.token) {\n    token = req.body.token\n  } else if (req.query && req.query.hasOwnProperty('access_token')) {\n    token = req.query.token\n  } else if (req.headers.authorization) {\n    token = req.headers.authorization\n  }\n  return token\n}\n\nexport default authService\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/auth/auth.service.js","module.exports = require(\"composable-middleware\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"composable-middleware\"\n// module id = 21\n// module chunks = 0","import organizationService from './organization.service'\nconst logger = require('../../config/logger')\n\nconst organizationController = {}\n\norganizationController.organizationRequest = function (req, res) {\n  organizationService.organizationRequest(req.body.userId, req.body.organizationInfo, function (error, organization) {\n    if (error) {\n      return handleError(res, error)\n    }\n    return res.status(200).json({organizationId: organization._id})\n  })\n}\n\norganizationController.organizationResponse = function (req, res) {\n  organizationService.organizationResponse(req.params.id, function (err, organization) {\n    if (err) {\n      return handleError(res, err)\n    }\n    if (!organization) {\n      return handleError(res, {name: 'ValidationError', message: 'organization does not exists', errors: 'organization does not exists or was processed'})\n    }\n    return res.status(200).json(organization)\n  })\n}\n\norganizationController.organizationResponseUpdate = function organizationResponseUpdate (req, res) {\n  organizationService.organizationResponseUpdate(req.params.id, req.params.paymentId, function (err, organization) {\n    if (err) {\n      return handleError(res, err)\n    }\n    if (!organization) {\n      return handleError(res, {name: 'ValidationError', message: 'organization was processed', errors: 'organization does not exists or was processed'})\n    }\n    return res.status(200).json(organization)\n  })\n}\n\norganizationController.getOrganization = function (req, res) {\n  organizationService.findById(req.params.organizationId, function (err, organization) {\n    if (err) {\n      return handleError(res, err)\n    }\n    return res.status(200).json(organization)\n  })\n}\n\nfunction handleError (res, err) {\n  let httpErrorCode = 500\n\n  if (err.name === 'ValidationError') {\n    httpErrorCode = 400\n  }\n  logger.log('error', err)\n\n  return res.status(httpErrorCode).json({code: err.name, message: err.message, errors: err.errors})\n}\n\nexport default organizationController\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/organization/organization.controller.js","'use strict'\n\nimport Organization from './organization.model.js'\nimport Blind from 'blind'\nimport config from '../../config/environment/index'\n\nconst organizationService = {}\n\norganizationService.save = function (organization, cb) {\n  // console.log('organization service',organization)\n  organization.save(function (err, data) {\n    if (err) {\n      return cb(err)\n    }\n    return cb(null, data)\n  })\n}\n\norganizationService.create = function (organization, cb) {\n  organization.create(organization, function (err, data) {\n    if (err) {\n      return cb(err)\n    }\n    return cb(null, data)\n  }\n  )\n}\n\norganizationService.findOne = function (filter, fields, cb) {\n  Organization.findOne(filter, fields, function (err, data) {\n    if (err) {\n      return cb(err)\n    }\n    return cb(null, data)\n  }\n  )\n}\n\norganizationService.findById = function (id, cb) {\n  Organization.findById(id, function (err, organization) {\n    if (err) {\n      return cb(err)\n    }\n    return cb(null, organization)\n  }\n  )\n}\n\norganizationService.find = function (filter, fields, cb) {\n  Organization.find(filter, fields, function (err, data) {\n    if (err) {\n      return cb(err)\n    }\n    return cb(null, data)\n  }\n  )\n}\n\norganizationService.update = function (filter, value, cb) {\n  Organization.update(filter, value, function (err, data) {\n    if (err) {\n      return cb(err)\n    }\n    return cb(null, data)\n  })\n}\n\norganizationService.encryptField = function (value) {\n  var encrypted = new Blind({ encryptKey: config.encryptKey }).encrypt(value)\n  return encrypted\n}\n\norganizationService.decryptField = function (encryptedValue) {\n  var decrypted = new Blind({ encryptKey: config.encryptKey }).decrypt(encryptedValue)\n  return decrypted\n}\n\norganizationService.getlast4Field = function (encryptedValue) {\n  let last4Field = organizationService.decryptField(encryptedValue)\n  return last4Field.substring(last4Field.length - 4, last4Field.length)\n}\n\norganizationService.organizationRequest = function (userId, dataOrganization, cb) {\n  dataOrganization.ownerId = userId\n  dataOrganization.aba = organizationService.encryptField(dataOrganization.aba)\n  dataOrganization.dda = organizationService.encryptField(dataOrganization.dda)\n  dataOrganization.ownerSSN = organizationService.encryptField(dataOrganization.ownerSSN)\n  let newOrganization = new Organization(dataOrganization)\n  organizationService.save(newOrganization, function (err, data) {\n    if (err) return cb(err)\n    return cb(null, data)\n  })\n}\n\norganizationService.organizationResponse = function (organizationId, cb) {\n  organizationService.findOne({verify: 'pending', _id: organizationId}, '', function (err, organization) {\n    if (err) return cb(err)\n    if (!organization) return cb(null)\n    organization.aba = organizationService.decryptField(organization.aba)\n    organization.dda = organizationService.decryptField(organization.dda)\n    organization.ownerSSN = organizationService.decryptField(organization.ownerSSN)\n    return cb(null, organization)\n  })\n}\n\norganizationService.organizationResponseUpdate = function (organizationId, paymentId, cb) {\n  organizationService.update({_id: organizationId}, {verify: 'done', aba: '', dda: '', ownerSSN: '', paymentId: paymentId}, function (err, organization) {\n    if (err) return cb(err)\n    return cb(null, organization)\n  })\n}\n\nexport default organizationService\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/organization/organization.service.js","'use strict'\n\nconst mongoose = require('mongoose')\nconst Schema = mongoose.Schema\nconst config = require('../../config/environment/index.js')\n\nlet organizationSchema = new Schema({\n  // Team info\n  // teamName: { type: String, default: true}, // email //response\n  // teamNumber: { type: String, default: '1'}, // email\n  // teamAverageSize: { type: String, default: '1' }, // email\n  // teamSport: {type: String},\n  // End team info\n  // Owner info\n  ownerId: { type: String },\n  ownerFirstName: { type: String, required: true }, // required //email //newDesign\n  ownerLastName: { type: String, required: true }, // required //email //newDesign\n  ownerDOB: { type: Date }, // required //email //newDesign\n  ownerSSN: { type: String, required: true }, // required //email //newDesign\n  ownerEmail: { type: String }, // email //response\n  ownerPhone: { type: String }, // email\n  // End owner info\n  // Billing info\n  country: { type: String, default: 'US' }, // required //email //response\n  state: { type: String, required: true }, // required //email //newDesign\n  city: { type: String, required: true }, // required //email //newDesign\n  zipCode: { type: String, required: true }, // required //newDesign\n  averagePayment: { type: String, default: '1' }, // email\n  EIN: { type: String }, // required //email //newDesign\n  Address: { type: String, required: true }, // required //email //newDesign\n  AddressLineTwo: { type: String }, // required //email //newDesign\n  website: { type: String, default: 'https://www.getpaidup.com' }, // email\n  businessName: { type: String, required: true }, // required //email //newDesign\n  // phoneNumber: { type: String, default: '0000000000'}, // email\n  businessType: { type: String, required: true }, // required //newDesign\n  // End billing info\n  // Billing info\n  aba: { type: String, required: true }, // required //email //response //newDesign\n  dda: { type: String, required: true }, // required //email //response //newDesign\n  // End billing info\n  createAt: { type: Date, default: new Date() },\n  updateAt: { type: Date, default: new Date() },\n  verify: { type: String, default: 'pending' },\n  referralCode: { type: String, default: '' }, // email\n  paymentId: { type: String, default: '' },\n  seasons: { type: [String], default: [] }\n})\n\n/**\n * Pre-save hook\n */\norganizationSchema.pre('save', function (next) {\n  if (!this.isNew) return next()\n  this.update_at = new Date()\n  next()\n})\n\nmodule.exports = mongoose.model(\n  'organization',\n  organizationSchema,\n  config.mongo.options.prefix + 'organizations'\n)\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/organization/organization.model.js","module.exports = require(\"blind\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"blind\"\n// module id = 25\n// module chunks = 0","'use strict'\n\nconst config = require('./environment')\nconst winston = require('winston')\nrequire('winston-loggly')\n\nlet env = process.env.NODE_ENV\n\nlet logger = new (winston.Logger)({\n  transports: [\n    new (winston.transports.Console)({\n      level: config.logger.level.info,\n      handleExceptions: true,\n      json: true,\n      colorize: true\n    }),\n    new (winston.transports.File)({\n      level: config.logger.level.warn,\n      handleExceptions: true,\n      json: true,\n      colorize: true,\n      filename: config.root + '/var/logs/all-logs.log',\n      maxsize: 5242880, // 5MB\n      maxFiles: 5\n    }),\n    new (winston.transports.Loggly)({\n      level: config.logger.loggly.level,\n      handleExceptions: true,\n      json: true,\n      inputToken: config.logger.loggly.inputToken,\n      subdomain: config.logger.loggly.subdomain,\n      tags: config.logger.loggly.tags\n    })\n  ],\n  exitOnError: false\n})\n\nwinston.emitErrs = true\n\nif (env === 'test') {\n  logger\n    .remove(winston.transports.File)\n    .remove(winston.transports.Console)\n    .remove(winston.transports.Loggly)\n}\n\nmodule.exports = logger\nmodule.exports.stream = {\n  write: function (message, encoding) {\n    logger.info(message)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/config/logger.js","module.exports = require(\"winston\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"winston\"\n// module id = 27\n// module chunks = 0","module.exports = require(\"winston-loggly\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"winston-loggly\"\n// module id = 28\n// module chunks = 0"],"sourceRoot":""}